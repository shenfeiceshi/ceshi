<!--抽奖记录页面-->
<view class="container">
  <!-- 页面标题 -->
  <view class="page-header">
    <view class="header-title">我的抽奖记录</view>
    <view class="header-subtitle">查看历史抽奖记录和获得的奖品</view>
  </view>

  <!-- 统计信息 -->
  <view class="stats-section">
    <view class="stats-card">
      <view class="stat-item">
        <view class="stat-number">{{totalLotteries}}</view>
        <view class="stat-label">总抽奖次数</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number">{{totalWins}}</view>
        <view class="stat-label">中奖次数</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-number">{{winRate}}%</view>
        <view class="stat-label">中奖率</view>
      </view>
    </view>
  </view>

  <!-- 筛选选项 -->
  <view class="filter-section">
    <view class="filter-tabs">
      <view class="filter-tab {{filterType === 'all' ? 'active' : ''}}" bindtap="setFilter" data-type="all">
        全部记录
      </view>
      <view class="filter-tab {{filterType === 'win' ? 'active' : ''}}" bindtap="setFilter" data-type="win">
        中奖记录
      </view>
      <view class="filter-tab {{filterType === 'recent' ? 'active' : ''}}" bindtap="setFilter" data-type="recent">
        最近一周
      </view>
    </view>
  </view>

  <!-- 记录列表 -->
  <view class="records-section">
    <view class="records-list" wx:if="{{filteredRecords.length > 0}}">
      <view class="record-item" wx:for="{{filteredRecords}}" wx:key="id">
        <view class="record-left">
          <view class="prize-emoji">{{item.prizeEmoji || '🎁'}}</view>
          <view class="record-info">
            <view class="prize-name">{{item.prizeName}}</view>
            <view class="record-time">{{item.date}} {{item.time}}</view>
          </view>
        </view>
        <view class="record-right">
          <view class="win-badge" wx:if="{{item.isWin}}">
            <view class="badge-emoji">🏆</view>
            <text>中奖</text>
          </view>
          <view class="no-win-badge" wx:else>
            <text>未中奖</text>
          </view>
          <view class="cost-info">-{{item.cost}}积分</view>
        </view>
      </view>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{filteredRecords.length === 0}}">
      <view class="empty-icon">🎲</view>
      <view class="empty-title">暂无抽奖记录</view>
      <view class="empty-desc">快去抽奖大厅试试手气吧！</view>
      <view class="empty-btn" bindtap="goToLottery">
        <view class="btn-emoji">🎰</view>
        <text>去抽奖</text>
      </view>
    </view>
  </view>

  <!-- 加载更多 -->
  <view class="load-more" wx:if="{{hasMore && filteredRecords.length > 0}}">
    <view class="load-btn" bindtap="loadMore">
      <text wx:if="{{!loading}}">加载更多</text>
      <text wx:else>加载中...</text>
    </view>
  </view>
</view>

<!-- 底部安全区域 -->
<view class="safe-area-bottom"></view>