<!--å°å…­æ—¥è®°åˆ—è¡¨é¡µé¢ - æœ‹å‹åœˆé£æ ¼-->
<view class="page-container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-content">
      <view class="header-left">
        <view class="page-title">å°å…­æ—¥è®°</view>
        <view class="page-subtitle">è®°å½•æˆé•¿çš„æ¯ä¸€å¤© âœ¨</view>
      </view>
      <view class="header-right">
        <view class="add-btn" bindtap="goToWrite">
          <text class="add-icon">+</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æˆé•¿ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-card">
    <view class="stats-item">
      <view class="stats-number">{{totalDiaries}}</view>
      <view class="stats-label">æ€»æ—¥è®°</view>
    </view>
    <view class="stats-divider"></view>
    <view class="stats-item">
      <view class="stats-number">{{thisMonthDiaries}}</view>
      <view class="stats-label">æœ¬æœˆ</view>
    </view>
    <view class="stats-divider"></view>
    <view class="stats-item">
      <view class="stats-number">{{continuousDays}}</view>
      <view class="stats-label">è¿ç»­å¤©æ•°</view>
    </view>
  </view>

  <!-- æ—¥è®°åˆ—è¡¨ - æœ‹å‹åœˆé£æ ¼ -->
  <view class="diary-timeline">
    <view class="diary-card" 
          wx:for="{{diaryList}}" 
          wx:key="id"
          bindtap="viewDiary" 
          data-id="{{item.id}}">
      
      <!-- å·¦ä¾§æ—¥æœŸæ ‡ç­¾ -->
      <view class="date-label">
        <view class="date-day">{{item.day}}</view>
        <view class="date-month">{{item.month}}</view>
        <view class="date-year">{{item.year}}</view>
      </view>

      <!-- å³ä¾§å†…å®¹åŒºåŸŸ -->
      <view class="diary-content">
        <!-- å¿ƒæƒ…å¤©æ°”æ ‡ç­¾ -->
        <view class="mood-weather-bar">
          <view class="mood-tag" wx:if="{{item.mood}}">
            <text class="mood-emoji">{{item.moodEmoji}}</text>
            <text class="mood-text">{{item.moodText}}</text>
          </view>
          <view class="weather-tag" wx:if="{{item.weather}}">
            <text class="weather-emoji">{{item.weatherEmoji}}</text>
            <text class="weather-text">{{item.weatherText}}</text>
          </view>
        </view>

        <!-- æ—¥è®°å†…å®¹é¢„è§ˆ -->
        <view class="content-preview">{{item.content}}</view>

        <!-- å›¾ç‰‡é¢„è§ˆ -->
        <view class="images-preview" wx:if="{{item.images && item.images.length > 0}}">
          <image class="preview-image" 
                 wx:for="{{item.images}}" 
                 wx:for-item="img" 
                 wx:key="*this"
                 src="{{img}}" 
                 mode="aspectFill"
                 wx:if="{{index < 3}}"></image>
          <view class="more-images" wx:if="{{item.images.length > 3}}">
            +{{item.images.length - 3}}
          </view>
        </view>

        <!-- AIè¯„ä»·é¢„è§ˆ -->
        <view class="ai-comment-preview" wx:if="{{item.aiComment}}">
          <view class="ai-avatar">ğŸ¤–</view>
          <view class="ai-comment-text">{{item.aiCommentPreview}}</view>
        </view>

        <!-- æ ‡ç­¾ -->
        <view class="tags-container" wx:if="{{item.tags && item.tags.length > 0}}">
          <view class="tag-item" wx:for="{{item.tags}}" wx:for-item="tag" wx:key="*this">
            #{{tag}}
          </view>
        </view>

        <!-- åº•éƒ¨æ—¶é—´å’Œæ“ä½œ -->
        <view class="diary-footer">
          <view class="create-time">{{item.createTime}}</view>
          <view class="action-buttons">
            <view class="action-btn" bindtap="editDiary" data-id="{{item.id}}" catchtap="true">
              <text class="action-icon">âœï¸</text>
            </view>
            <view class="action-btn" bindtap="shareDiary" data-id="{{item.id}}" catchtap="true">
              <text class="action-icon">ğŸ“¤</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{diaryList.length === 0}}">
      <view class="empty-icon">ğŸ“</view>
      <view class="empty-title">è¿˜æ²¡æœ‰æ—¥è®°å“¦</view>
      <view class="empty-desc">å¿«æ¥è®°å½•ä»Šå¤©çš„ç¾å¥½æ—¶å…‰å§ï¼</view>
      <view class="empty-action" bindtap="goToWrite">
        <text class="action-text">å†™ç¬¬ä¸€ç¯‡æ—¥è®°</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{hasMore && diaryList.length > 0}}">
    <view class="load-btn" bindtap="loadMore" wx:if="{{!loading}}">
      <text>æŸ¥çœ‹æ›´å¤šæ—¥è®°</text>
    </view>
    <view class="loading-indicator" wx:else>
      <view class="loading-dot"></view>
      <view class="loading-dot"></view>
      <view class="loading-dot"></view>
    </view>
  </view>
</view>

<!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
<view class="safe-area-bottom"></view>