# 微信小程序域名白名单配置说明

## 问题描述
当前扣子API请求失败，错误信息：`request:fail url not in domain list`

这是因为微信小程序要求所有网络请求的域名必须在域名白名单中配置。

## 解决方案

### 1. 在微信公众平台配置域名白名单

1. 登录 [微信公众平台](https://mp.weixin.qq.com/)
2. 进入小程序管理后台
3. 选择 "开发" -> "开发管理" -> "开发设置"
4. 在 "服务器域名" 部分，添加以下域名到 "request合法域名"：

```
https://api.coze.cn
```

### 2. 本地开发环境配置

在 `project.config.json` 中可以临时关闭域名校验（仅用于开发调试）：

```json
{
  "setting": {
    "urlCheck": false
  }
}
```

**注意：** 这个设置只在开发工具中生效，正式发布时仍需要配置域名白名单。

### 3. 当前API配置

- **API地址：** `https://api.coze.cn/open_api/v2/chat`
- **请求方法：** POST
- **认证方式：** Bearer Token

### 4. 验证配置

配置完成后，重新编译小程序并测试AI生成图片功能。

## 注意事项

1. 域名白名单配置后需要重新发布小程序才能生效
2. 开发环境可以通过设置 `urlCheck: false` 临时跳过域名检查
3. 确保API Token有效且有足够的调用额度